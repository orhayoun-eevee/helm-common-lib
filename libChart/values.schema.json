{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "additionalProperties": false,
  "description": "Schema for lib-chart Helm library chart values",
  "properties": {
    "global": {
      "type": "object",
      "additionalProperties": false,
      "description": "Global configuration for all resources",
      "required": ["name", "namespace"],
      "properties": {
        "name": {
          "oneOf": [
            {
              "type": "string",
              "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$",
              "minLength": 1,
              "maxLength": 253
            },
            {
              "type": "string",
              "enum": [""]
            }
          ],
          "description": "REQUIRED when used - application name (e.g., 'radarr', 'sonarr'). Must be set by consuming charts. Empty string allowed in defaults for library charts."
        },
        "namespace": {
          "type": "string",
          "description": "Namespace for all resources",
          "default": "default",
          "pattern": "^[a-z0-9]([-a-z0-9]*[a-z0-9])?$",
          "maxLength": 253
        },
        "chart": {
          "type": "object",
          "additionalProperties": false,
          "description": "Optional - parent chart information (for correct labels)",
          "properties": {
            "name": {
              "type": "string",
              "description": "Parent chart name (e.g., 'radarr')"
            },
            "version": {
              "type": "string",
              "description": "Parent chart version (e.g., '0.1.0')"
            },
            "appVersion": {
              "type": "string",
              "description": "Parent chart appVersion"
            }
          }
        },
        "labels": {
          "type": "object",
          "description": "Global labels applied to all resources",
          "additionalProperties": {
            "type": "string"
          },
          "properties": {
            "partOf": {
              "type": "string",
              "description": "Optional - name of higher level application (e.g., 'media-center')"
            },
            "component": {
              "type": "string",
              "description": "Optional - workload component type (e.g., 'frontend', 'api', 'worker')"
            },
            "overrides": {
              "type": "object",
              "description": "Optional - map to override any standard label (e.g., 'app.kubernetes.io/name': 'custom-name')",
              "additionalProperties": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    "deployment": {
      "type": "object",
      "additionalProperties": false,
      "description": "Deployment configuration",
      "properties": {
        "replicas": {
          "type": "integer",
          "description": "Number of replicas",
          "minimum": 0,
          "default": 1
        },
        "strategy": {
          "type": "object",
          "additionalProperties": false,
          "description": "Deployment strategy",
          "properties": {
            "type": {
              "type": "string",
              "enum": ["Recreate", "RollingUpdate"],
              "description": "Deployment strategy type",
              "default": "Recreate"
            }
          }
        },
        "revisionHistoryLimit": {
          "type": "integer",
          "description": "Number of old ReplicaSets to retain",
          "minimum": 0,
          "default": 3
        },
        "imagePullSecrets": {
          "type": "array",
          "description": "Image pull secrets",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "name": {
                "type": "string"
              }
            },
            "required": ["name"]
          }
        },
        "terminationGracePeriodSeconds": {
          "type": "integer",
          "description": "Termination grace period in seconds",
          "minimum": 0,
          "default": 30
        },
        "podLabels": {
          "type": "object",
          "description": "Additional pod labels",
          "additionalProperties": {
            "type": "string"
          }
        },
        "podSecurityContext": {
          "$ref": "#/$defs/securityContext",
          "description": "Pod security context - secure defaults"
        },
        "defaultContainerSecurityContext": {
          "$ref": "#/$defs/securityContext",
          "description": "Default securityContext applied to all containers unless overridden"
        },
        "containers": {
          "type": "object",
          "description": "Map of containers - NO DEFAULT, must be explicitly defined by service chart",
          "additionalProperties": {
            "$ref": "#/$defs/container"
          }
        },
        "initContainers": {
          "type": "object",
          "description": "Map of init containers",
          "additionalProperties": {
            "$ref": "#/$defs/initContainer"
          }
        },
        "dnsPolicy": {
          "type": "string",
          "enum": ["ClusterFirst", "ClusterFirstWithHostNet", "Default", "None"],
          "description": "DNS policy for pods"
        },
        "automountServiceAccountToken": {
          "type": "boolean",
          "description": "Whether to automount service account token"
        },
        "enableServiceLinks": {
          "type": "boolean",
          "description": "Whether to enable service links"
        }
      }
    },
    "persistence": {
      "type": "object",
      "additionalProperties": false,
      "description": "Feature: Persistence",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Feature flag - enable persistence (PVC + volumes)",
          "default": false
        },
        "claims": {
          "type": "object",
          "description": "Persistent Volume Claims - Dictionary of PVC definitions. Each key is the claim name suffix (full name: {global.name}-{key})",
          "additionalProperties": {
            "type": "object",
            "additionalProperties": false,
            "required": ["storageClass", "size"],
            "properties": {
              "size": {
                "type": "string",
                "description": "Storage size (e.g., '1Gi', '10Gi')",
                "pattern": "^[0-9]+(\\.[0-9]+)?(Ki|Mi|Gi|Ti|Pi|Ei|k|M|G|T|P|E)?$"
              },
              "storageClass": {
                "type": "string",
                "description": "REQUIRED - storage class name"
              },
              "accessMode": {
                "type": "string",
                "enum": ["ReadWriteOnce", "ReadOnlyMany", "ReadWriteMany", "ReadWriteOncePod"],
                "description": "Access mode for PVC",
                "default": "ReadWriteOnce"
              },
              "retain": {
                "type": "boolean",
                "description": "Retain PVC on release deletion (adds helm.sh/resource-policy: keep)",
                "default": false
              }
            }
          }
        },
        "volumes": {
          "type": "array",
          "description": "Deployment Volumes - List of volume definitions. Define standard Kubernetes volume specs (nfs, hostPath, emptyDir, secret, configMap, etc.)",
          "items": {
            "type": "object",
            "description": "Kubernetes volume specification"
          }
        }
      }
    },
    "metrics": {
      "type": "object",
      "additionalProperties": false,
      "description": "Feature: Observability",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Feature flag - enable metrics (ServiceMonitor + PrometheusRule)",
          "default": false
        },
        "serviceMonitor": {
          "type": "object",
          "additionalProperties": false,
          "description": "ServiceMonitor Configuration",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Enable ServiceMonitor resource creation",
              "default": true
            },
            "port": {
              "type": "integer",
              "description": "Metrics port",
              "minimum": 1,
              "maximum": 65535,
              "default": 9100
            },
            "interval": {
              "type": "string",
              "description": "ServiceMonitor scrape interval",
              "pattern": "^[0-9]+(s|m|h)?$",
              "default": "10s"
            },
            "scrapeTimeout": {
              "type": "string",
              "description": "ServiceMonitor scrape timeout",
              "pattern": "^[0-9]+(s|m|h)?$",
              "default": "5s"
            },
            "path": {
              "type": "string",
              "description": "Optional - Metrics endpoint path (e.g., '/metrics')"
            },
            "honorLabels": {
              "type": "boolean",
              "description": "Optional - Honor labels from target (boolean)",
              "default": false
            },
            "selector": {
              "type": "object",
              "description": "Selector for ServiceMonitor spec. Allows customizing which services are selected for scraping. Supports both matchLabels and matchExpressions"
            },
            "namespaceSelector": {
              "type": "object",
              "description": "Namespace selector for ServiceMonitor spec. Allows selecting namespaces to scrape from"
            },
            "relabelings": {
              "type": "array",
              "description": "Relabelings - Prometheus relabel configs (applied before scraping). Full Prometheus relabeling configuration format",
              "items": {
                "type": "object"
              }
            },
            "metricRelabelings": {
              "type": "array",
              "description": "Metric relabelings - Prometheus relabel configs (applied after scraping). Full Prometheus relabeling configuration format",
              "items": {
                "type": "object"
              }
            }
          }
        },
        "prometheusRule": {
          "type": "object",
          "additionalProperties": false,
          "description": "PrometheusRule Configuration",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Enable PrometheusRule resource creation",
              "default": true
            },
            "rules": {
              "type": "array",
              "description": "Custom Alert Rules. Define service-specific alerts here as an array of PrometheusRule alert definitions",
              "items": {
                "type": "object",
                "description": "Prometheus alert rule"
              }
            }
          }
        },
        "grafana": {
          "type": "object",
          "additionalProperties": false,
          "description": "Grafana Configuration",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Feature flag - enable Grafana dashboard ConfigMaps",
              "default": false
            },
            "dashboard": {
              "type": "object",
              "additionalProperties": false,
              "description": "Grafana dashboard ConfigMap generation",
              "properties": {
                "enabled": {
                  "type": "boolean",
                  "description": "Enable Grafana dashboard ConfigMap generation",
                  "default": false
                },
                "items": {
                  "type": "object",
                  "description": "Dictionary of dashboard items - each key becomes a ConfigMap suffix. Each item will generate a ConfigMap named: {global.name}-{key}",
                  "additionalProperties": {
                    "type": "object",
                    "additionalProperties": false,
                    "properties": {
                      "name": {
                        "type": "string",
                        "description": "Optional - ConfigMap data key name (defaults to key)"
                      },
                      "json": {
                        "type": "string",
                        "description": "Grafana dashboard JSON"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "serviceAccount": {
      "type": "object",
      "additionalProperties": false,
      "description": "Service Account configuration",
      "properties": {
        "create": {
          "type": "boolean",
          "description": "Whether to create a service account",
          "default": true
        },
        "automount": {
          "type": "boolean",
          "description": "SECURITY: Disabled by default. Enable only if service needs K8s API access",
          "default": false
        },
        "annotations": {
          "type": "object",
          "description": "Service account annotations",
          "additionalProperties": {
            "type": "string"
          }
        },
        "name": {
          "type": "string",
          "description": "Service account name (defaults to {global.name} if not specified)"
        }
      }
    },
    "podDisruptionBudget": {
      "type": "object",
      "additionalProperties": false,
      "description": "Pod disruption budget configuration",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Disabled by default - opt-in per service",
          "default": false
        },
        "minAvailable": {
          "oneOf": [
            {
              "type": "integer",
              "minimum": 0
            },
            {
              "type": "string",
              "pattern": "^[0-9]+%$"
            },
            {
              "type": "null"
            }
          ],
          "description": "Minimum available pods (mutually exclusive with maxUnavailable)"
        },
        "maxUnavailable": {
          "oneOf": [
            {
              "type": "integer",
              "minimum": 0
            },
            {
              "type": "string",
              "pattern": "^[0-9]+%$"
            },
            {
              "type": "null"
            }
          ],
          "description": "Maximum unavailable pods (mutually exclusive with minAvailable)"
        },
        "unhealthyPodEvictionPolicy": {
          "type": ["string", "null"],
          "enum": ["IfHealthyBudget", "AlwaysAllow", null],
          "description": "Optional - 'IfHealthyBudget' (default) or 'AlwaysAllow' (K8s 1.26+)"
        }
      }
    },
    "secrets": {
      "type": "object",
      "additionalProperties": false,
      "description": "Feature: Secrets",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Feature flag - enable secrets management",
          "default": false
        },
        "sealedSecret": {
          "type": "object",
          "additionalProperties": false,
          "description": "SealedSecret configuration",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Feature flag - enable SealedSecret generation",
              "default": false
            },
            "items": {
              "type": "object",
              "description": "Dictionary of sealed secret definitions. Each key is the secret name",
              "additionalProperties": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "data": {
                    "type": "object",
                    "description": "Encrypted data - map of key to encrypted value",
                    "additionalProperties": {
                      "type": "string"
                    }
                  },
                  "annotations": {
                    "type": "object",
                    "description": "SealedSecret metadata annotations",
                    "additionalProperties": {
                      "type": "string"
                    }
                  },
                  "labels": {
                    "type": "object",
                    "description": "Labels for the generated Secret (in template.metadata.labels)",
                    "additionalProperties": {
                      "type": "string"
                    }
                  },
                  "templateAnnotations": {
                    "type": "object",
                    "description": "Annotations for the generated Secret (in template.metadata.annotations)",
                    "additionalProperties": {
                      "type": "string"
                    }
                  },
                  "type": {
                    "type": "string",
                    "description": "Secret type (defaults to 'Opaque')",
                    "default": "Opaque"
                  }
                },
                "required": ["data"]
              }
            }
          }
        }
      }
    },
    "network": {
      "type": "object",
      "additionalProperties": false,
      "description": "Network configuration",
      "properties": {
        "enabled": {
          "type": "boolean",
          "description": "Enable network features",
          "default": true
        },
        "httpRoute": {
          "type": "object",
          "additionalProperties": false,
          "description": "HTTPRoute configuration (Gateway API + security policies)",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Feature flag - enable HTTPRoute",
              "default": false
            },
            "host": {
              "type": "string",
              "description": "REQUIRED when enabled - hostname (e.g., 'radarr-k8s.orhayoun.com')"
            },
            "port": {
              "type": "integer",
              "description": "Service port to route to (defaults to first container port if not specified)",
              "minimum": 1,
              "maximum": 65535,
              "default": 80
            },
            "gateway": {
              "type": "object",
              "additionalProperties": false,
              "description": "Gateway reference",
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Gateway name",
                  "default": "shared-platform-gateway"
                },
                "namespace": {
                  "type": "string",
                  "description": "Gateway namespace",
                  "default": "istio-system"
                }
              }
            },
            "routes": {
              "type": "array",
              "description": "HTTPRoute configuration - define routes for different listeners",
              "items": {
                "type": "object",
                "additionalProperties": false,
                "required": ["name"],
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Route name"
                  },
                  "enabled": {
                    "type": "boolean",
                    "description": "Whether this route is enabled",
                    "default": true
                  },
                  "listener": {
                    "type": "object",
                    "additionalProperties": false,
                    "properties": {
                      "sectionName": {
                        "type": "string",
                        "description": "Listener section name (e.g., 'https', 'http')"
                      },
                      "port": {
                        "type": "integer",
                        "description": "Listener port",
                        "minimum": 1,
                        "maximum": 65535
                      }
                    }
                  },
                  "rules": {
                    "type": "array",
                    "description": "Route rules. Supports template strings that will be evaluated at render time",
                    "items": {
                      "type": "object",
                      "description": "HTTPRoute rule"
                    }
                  },
                  "matches": {
                    "type": "array",
                    "description": "Route matches (alternative to rules)",
                    "items": {
                      "type": "object",
                      "description": "HTTPRoute match"
                    }
                  },
                  "backendRefs": {
                    "type": "array",
                    "description": "Backend references",
                    "items": {
                      "type": "object",
                      "description": "Backend reference"
                    }
                  },
                  "filters": {
                    "type": "array",
                    "description": "Route filters",
                    "items": {
                      "type": "object",
                      "description": "HTTPRoute filter"
                    }
                  }
                }
              }
            }
          }
        },
        "networkPolicy": {
          "type": "object",
          "additionalProperties": false,
          "description": "NetworkPolicy Configuration - Multiple policies support",
          "properties": {
            "items": {
              "type": "object",
              "description": "Map of policy name suffix to NetworkPolicy configuration. Each policy will be named: {global.name}-{key}",
              "additionalProperties": {
                "type": "object",
                "description": "NetworkPolicy specification (excluding podSelector, which is auto-injected)",
                "properties": {
                  "enabled": {
                    "type": "boolean",
                    "description": "Whether this policy is enabled",
                    "default": true
                  },
                  "policyTypes": {
                    "type": "array",
                    "description": "Policy types",
                    "items": {
                      "type": "string",
                      "enum": ["Ingress", "Egress"]
                    }
                  },
                  "ingress": {
                    "type": "array",
                    "description": "Ingress rules. Full NetworkPolicy spec format. Template variables can be used: {global.name}, {service.port}, {metrics.serviceMonitor.port}, {httpRoute.gateway.namespace}, {httpRoute.gateway.name}",
                    "items": {
                      "type": "object",
                      "description": "NetworkPolicy ingress rule"
                    }
                  },
                  "egress": {
                    "type": "array",
                    "description": "Egress rules. Full NetworkPolicy spec format. Template variables can be used: {global.name}, {service.port}, {metrics.serviceMonitor.port}, {httpRoute.gateway.namespace}, {httpRoute.gateway.name}",
                    "items": {
                      "type": "object",
                      "description": "NetworkPolicy egress rule"
                    }
                  }
                }
              }
            }
          }
        },
        "services": {
          "type": "object",
          "additionalProperties": false,
          "description": "Service Configuration - Multiple services support",
          "properties": {
            "items": {
              "type": "object",
              "description": "Map of service name suffix to service configuration. Each service will be named: {global.name}-{key}",
              "additionalProperties": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "enabled": {
                    "type": "boolean",
                    "description": "Whether this service is enabled",
                    "default": true
                  },
                  "type": {
                    "type": "string",
                    "enum": ["ClusterIP", "NodePort", "LoadBalancer", "ExternalName"],
                    "description": "Service type",
                    "default": "ClusterIP"
                  },
                  "ports": {
                    "type": "object",
                    "description": "Service ports - map of port name to port configuration. REQUIRED when service is enabled",
                    "additionalProperties": {
                      "type": "object",
                      "additionalProperties": false,
                      "required": ["port", "targetPort"],
                      "properties": {
                        "port": {
                          "type": "integer",
                          "description": "Service port",
                          "minimum": 1,
                          "maximum": 65535
                        },
                        "targetPort": {
                          "oneOf": [
                            {
                              "type": "integer",
                              "minimum": 1,
                              "maximum": 65535
                            },
                            {
                              "type": "string"
                            }
                          ],
                          "description": "Target port (container port name or number)"
                        },
                        "protocol": {
                          "type": "string",
                          "enum": ["TCP", "UDP", "SCTP"],
                          "description": "Protocol",
                          "default": "TCP"
                        }
                      }
                    }
                  },
                  "annotations": {
                    "type": "object",
                    "description": "Service annotations",
                    "additionalProperties": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "networkpolicies": {
          "type": "object",
          "description": "DEPRECATED: Use network.networkPolicy.items instead. Legacy NetworkPolicy configuration (not used by templates)"
        },
        "istio": {
          "type": "object",
          "additionalProperties": false,
          "description": "Istio configuration",
          "properties": {
            "enabled": {
              "type": "boolean",
              "description": "Enable Istio features",
              "default": true
            },
            "authorizationPolicy": {
              "type": "object",
              "additionalProperties": false,
              "description": "AuthorizationPolicy Configuration - Multiple policies support",
              "properties": {
                "enabled": {
                  "type": "boolean",
                  "description": "Feature flag - enable AuthorizationPolicy generation",
                  "default": false
                },
                "items": {
                  "type": "object",
                  "description": "Map of policy name suffix to AuthorizationPolicy configuration. Each policy will be named: {global.name}-{key}",
                  "additionalProperties": {
                    "type": "object",
                    "description": "AuthorizationPolicy specification (excluding selector, which is auto-injected)",
                    "properties": {
                      "enabled": {
                        "type": "boolean",
                        "description": "Whether this policy is enabled",
                        "default": true
                      },
                      "action": {
                        "type": "string",
                        "enum": ["ALLOW", "DENY", "AUDIT", "CUSTOM"],
                        "description": "AuthorizationPolicy action",
                        "default": "ALLOW"
                      },
                      "rules": {
                        "type": "array",
                        "description": "AuthorizationPolicy rules. Template variables can be used: {global.name}, {service.port}, {metrics.serviceMonitor.port}, {httpRoute.gateway.namespace}, {httpRoute.gateway.name}",
                        "items": {
                          "type": "object",
                          "description": "AuthorizationPolicy rule"
                        }
                      }
                    }
                  }
                }
              }
            },
            "destinationrule": {
              "type": "object",
              "additionalProperties": false,
              "description": "DestinationRule Configuration (Circuit Breaker)",
              "properties": {
                "enabled": {
                  "type": "boolean",
                  "description": "Opt-in feature - disabled by default",
                  "default": false
                },
                "host": {
                  "type": "string",
                  "description": "REQUIRED when enabled - destination service hostname (e.g., 'service-name.namespace.svc.cluster.local')"
                },
                "trafficPolicy": {
                  "type": "object",
                  "description": "Traffic policy configuration (connection pooling and outlier detection)",
                  "properties": {
                    "connectionPool": {
                      "type": "object",
                      "description": "Connection pool settings",
                      "properties": {
                        "tcp": {
                          "type": "object",
                          "description": "TCP connection pool",
                          "properties": {
                            "maxConnections": {
                              "type": "integer",
                              "description": "Maximum number of TCP connections",
                              "minimum": 1,
                              "default": 100
                            }
                          }
                        },
                        "http": {
                          "type": "object",
                          "description": "HTTP connection pool",
                          "properties": {
                            "http1MaxPendingRequests": {
                              "type": "integer",
                              "description": "Max pending HTTP/1.1 requests",
                              "minimum": 0,
                              "default": 10
                            },
                            "http2MaxRequests": {
                              "type": "integer",
                              "description": "Max concurrent HTTP/2 requests",
                              "minimum": 1,
                              "default": 100
                            },
                            "maxRequestsPerConnection": {
                              "type": "integer",
                              "description": "Max requests per HTTP/2 connection",
                              "minimum": 1,
                              "default": 2
                            }
                          }
                        }
                      }
                    },
                    "outlierDetection": {
                      "type": "object",
                      "description": "Outlier detection settings",
                      "properties": {
                        "consecutive5xxErrors": {
                          "type": "integer",
                          "description": "Eject after N consecutive 5xx errors",
                          "minimum": 1,
                          "default": 5
                        },
                        "interval": {
                          "type": "string",
                          "description": "Time between ejection scans",
                          "pattern": "^[0-9]+(s|m|h)?$",
                          "default": "30s"
                        },
                        "baseEjectionTime": {
                          "type": "string",
                          "description": "Base time a host is ejected",
                          "pattern": "^[0-9]+(s|m|h)?$",
                          "default": "30s"
                        },
                        "maxEjectionPercent": {
                          "type": "integer",
                          "description": "Maximum percentage of hosts ejected",
                          "minimum": 0,
                          "maximum": 100,
                          "default": 50
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "$defs": {
    "securityContext": {
      "type": "object",
      "description": "Security context for pods or containers",
      "properties": {
        "runAsNonRoot": {
          "type": "boolean",
          "description": "Run as non-root user"
        },
        "runAsUser": {
          "type": "integer",
          "description": "User ID to run as",
          "minimum": 0
        },
        "runAsGroup": {
          "type": "integer",
          "description": "Group ID to run as",
          "minimum": 0
        },
        "fsGroup": {
          "type": "integer",
          "description": "File system group ID",
          "minimum": 0
        },
        "seccompProfile": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "type": {
              "type": "string",
              "enum": ["RuntimeDefault", "Localhost", "Unconfined"]
            }
          }
        },
        "appArmorProfile": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "type": {
              "type": "string",
              "enum": ["RuntimeDefault", "Localhost", "Unconfined"]
            }
          }
        },
        "allowPrivilegeEscalation": {
          "type": "boolean",
          "description": "Allow privilege escalation"
        },
        "readOnlyRootFilesystem": {
          "type": "boolean",
          "description": "Mount root filesystem as read-only"
        },
        "capabilities": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "add": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "drop": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        }
      }
    },
    "container": {
      "type": "object",
      "additionalProperties": false,
      "description": "Container specification",
      "required": ["image"],
      "properties": {
        "image": {
          "type": "object",
          "additionalProperties": false,
          "required": ["repository", "tag"],
          "properties": {
            "repository": {
              "type": "string",
              "description": "Container image repository"
            },
            "tag": {
              "type": "string",
              "description": "Container image tag"
            },
            "digest": {
              "type": "string",
              "description": "Container image digest (optional, used with tag)"
            },
            "pullPolicy": {
              "type": "string",
              "enum": ["Always", "IfNotPresent", "Never"],
              "description": "Image pull policy",
              "default": "IfNotPresent"
            }
          }
        },
        "ports": {
          "type": "array",
          "description": "Container ports",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": ["name", "containerPort"],
            "properties": {
              "name": {
                "type": "string",
                "description": "Port name"
              },
              "containerPort": {
                "type": "integer",
                "description": "Container port number",
                "minimum": 1,
                "maximum": 65535
              },
              "protocol": {
                "type": "string",
                "enum": ["TCP", "UDP", "SCTP"],
                "description": "Protocol",
                "default": "TCP"
              }
            }
          }
        },
        "command": {
          "type": "array",
          "description": "Container command",
          "items": {
            "type": "string"
          }
        },
        "args": {
          "type": "array",
          "description": "Container arguments",
          "items": {
            "type": "string"
          }
        },
        "env": {
          "type": "array",
          "description": "Environment variables",
          "items": {
            "type": "object",
            "description": "Environment variable"
          }
        },
        "envFrom": {
          "type": "array",
          "description": "Environment variables from sources",
          "items": {
            "type": "object",
            "description": "Environment variable source"
          }
        },
        "volumeMounts": {
          "type": "array",
          "description": "Volume mounts",
          "items": {
            "type": "object",
            "description": "Volume mount"
          }
        },
        "resources": {
          "type": "object",
          "description": "Resource requirements",
          "properties": {
            "requests": {
              "type": "object",
              "description": "Resource requests",
              "additionalProperties": {
                "oneOf": [
                  {
                    "type": "string",
                    "pattern": "^[0-9]+(\\.[0-9]+)?(m|Ki|Mi|Gi|Ti|Pi|Ei)?$"
                  },
                  {
                    "type": "integer"
                  }
                ]
              }
            },
            "limits": {
              "type": "object",
              "description": "Resource limits",
              "additionalProperties": {
                "oneOf": [
                  {
                    "type": "string",
                    "pattern": "^[0-9]+(\\.[0-9]+)?(m|Ki|Mi|Gi|Ti|Pi|Ei)?$"
                  },
                  {
                    "type": "integer"
                  }
                ]
              }
            }
          }
        },
        "livenessProbe": {
          "type": "object",
          "description": "Liveness probe"
        },
        "readinessProbe": {
          "type": "object",
          "description": "Readiness probe"
        },
        "startupProbe": {
          "type": "object",
          "description": "Startup probe"
        },
        "lifecycle": {
          "type": "object",
          "description": "Container lifecycle hooks",
          "properties": {
            "preStop": {
              "type": "object",
              "description": "Pre-stop hook"
            },
            "postStart": {
              "type": "object",
              "description": "Post-start hook"
            }
          }
        },
        "securityContext": {
          "$ref": "#/$defs/securityContext",
          "description": "Container security context (overrides defaultContainerSecurityContext)"
        }
      }
    },
    "initContainer": {
      "type": "object",
      "additionalProperties": false,
      "description": "Init container specification",
      "required": ["image"],
      "properties": {
        "image": {
          "type": "object",
          "additionalProperties": false,
          "required": ["repository", "tag"],
          "properties": {
            "repository": {
              "type": "string",
              "description": "Container image repository"
            },
            "tag": {
              "type": "string",
              "description": "Container image tag"
            },
            "digest": {
              "type": "string",
              "description": "Container image digest (optional, used with tag)"
            },
            "pullPolicy": {
              "type": "string",
              "enum": ["Always", "IfNotPresent", "Never"],
              "description": "Image pull policy",
              "default": "IfNotPresent"
            }
          }
        },
        "command": {
          "type": "array",
          "description": "Container command",
          "items": {
            "type": "string"
          }
        },
        "args": {
          "type": "array",
          "description": "Container arguments",
          "items": {
            "type": "string"
          }
        },
        "env": {
          "type": "array",
          "description": "Environment variables",
          "items": {
            "type": "object",
            "description": "Environment variable"
          }
        },
        "volumeMounts": {
          "type": "array",
          "description": "Volume mounts",
          "items": {
            "type": "object",
            "description": "Volume mount"
          }
        },
        "securityContext": {
          "$ref": "#/$defs/securityContext",
          "description": "Init container security context"
        }
      }
    }
  }
}
