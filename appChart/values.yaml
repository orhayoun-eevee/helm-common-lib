# Default values for app-template
# This chart wraps libChart to provide a standardized application deployment interface.
# All values are passed directly to libChart - no prefix needed.

# ----------------------------------------------------------------------------
# Global Configuration
# ----------------------------------------------------------------------------
global:
  name: ""  # REQUIRED - application name (e.g., "radarr", "sonarr")
  namespace: default  # Namespace for all resources
  nfsServer: ""  # Optional - NFS server hostname/IP for NFS volumes
  # Optional - parent chart information (for correct labels)
  chart:
    name: ""  # Parent chart name (e.g., "radarr")
    version: ""  # Parent chart version (e.g., "0.1.0")
    appVersion: ""  # Parent chart appVersion
  labels:
    partOf: ""  # Optional - name of higher level application (e.g., "media-center")
    overrides: {}  # Optional - map to override any standard label (e.g., "app.kubernetes.io/name": "custom-name")

# ----------------------------------------------------------------------------
# Service Configuration
# ----------------------------------------------------------------------------
service:
  type: ClusterIP  # Service type
  ports: {}  # Map of port name to port configuration
  annotations: {}  # Optional service annotations

# ----------------------------------------------------------------------------
# Deployment Configuration
# ----------------------------------------------------------------------------
deployment:
  replicas: 1
  strategy:
    type: Recreate
  revisionHistoryLimit: 3
  imagePullSecrets: []
  terminationGracePeriodSeconds: 30
  podLabels: {}
  podSecurityContext:
    runAsNonRoot: true
    seccompProfile:
      type: RuntimeDefault
  defaultContainerSecurityContext:
    allowPrivilegeEscalation: false
    readOnlyRootFilesystem: false
    runAsNonRoot: true
    capabilities:
      drop:
        - ALL
    seccompProfile:
      type: RuntimeDefault
    appArmorProfile:
      type: RuntimeDefault
  containers: {}  # REQUIRED - must be defined by application chart
  initContainers: {}

# ----------------------------------------------------------------------------
# Feature: Persistence
# ----------------------------------------------------------------------------
persistence:
  enabled: false
  claims: {}  # Map of PVC definitions
  volumes: []  # List of volume definitions

# ----------------------------------------------------------------------------
# Feature: Networking (Gateway API & Security)
# ----------------------------------------------------------------------------
httpRoute:
  enabled: false
  host: ""
  port: 80
  gateway:
    name: shared-platform-gateway
    namespace: istio-system
  routes: []

# ----------------------------------------------------------------------------
# Feature: Observability
# ----------------------------------------------------------------------------
metrics:
  enabled: false
  port: 9100
  component: ""
  interval: "10s"
  scrapeTimeout: "5s"
  rules: []

# ----------------------------------------------------------------------------
# Service Account
# ----------------------------------------------------------------------------
serviceAccount:
  create: true
  automount: false
  annotations: {}
  name: ""

# ----------------------------------------------------------------------------
# Pod disruption budget configuration
# ----------------------------------------------------------------------------
podDisruptionBudget:
  enabled: false
  minAvailable: null
  maxUnavailable: null

# ----------------------------------------------------------------------------
# Security Configuration (Custom Policies)
# ----------------------------------------------------------------------------
security:
  authorizationPolicies: {}  # Map of AuthorizationPolicy specs
  networkPolicy: null  # NetworkPolicy spec (object, not map)

# ----------------------------------------------------------------------------
# Circuit Breaker Configuration (Istio DestinationRule)
# ----------------------------------------------------------------------------
circuitBreaker:
  enabled: false
  trafficPolicy:
    connectionPool:
      tcp:
        maxConnections: 100
      http:
        http1MaxPendingRequests: 10
        http2MaxRequests: 100
        maxRequestsPerConnection: 2
    outlierDetection:
      consecutive5xxErrors: 5
      interval: 30s
      baseEjectionTime: 30s
      maxEjectionPercent: 50

